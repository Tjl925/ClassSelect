"use strict";const e=require("../../../common/vendor.js"),a=require("../../../uni_modules/uni-id-pages/common/store.js"),i=require("../../../common/assets.js");e.Zs.importObject("uni-id-co");const t=e.Zs.database(),r={data:()=>({material:{material_name:"",course_name:"",category:"",material_image:[],download_link:"",article_status:1}}),computed:{userInfo:()=>a.store.userInfo},onLoad(){e.index.setNavigationBarTitle({title:"上传资料信息"})},methods:{navBack(){e.index.navigateBack()},async submitMaterialInfo(){try{e.index.showLoading({title:"提交中...",mask:!0});const a={creator_id:this.userInfo._id,created_at:(new Date).toISOString(),material_name:this.material.material_name,course_name:this.material.course_name,category:this.material.category,material_image:this.material.material_image,download_link:this.material.download_link,article_status:1};if(!(await t.collection("materials").add(a)).result.id)throw new Error("创建成功");e.index.showToast({title:"创建成功",icon:"success"}),this.material={material_name:"",course_name:"",category:"",material_image:[],download_link:""},setTimeout((()=>{e.index.navigateBack()}),2e3)}catch(a){console.error("提交资料信息失败:",a),e.index.showToast({title:a.message||"提交失败",icon:"none"})}finally{e.index.hideLoading(),setTimeout((()=>{e.index.switchTab({url:"/pages/material/material"})}),2500)}}}};if(!Array){(e.resolveComponent("uni-file-picker")+e.resolveComponent("uni-forms-item"))()}Math||((()=>"../../../uni_modules/uni-file-picker/components/uni-file-picker/uni-file-picker.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js"))();const o=e._export_sfc(r,[["render",function(a,t,r,o,n,m){return{a:e.o((e=>n.material.material_image=e)),b:e.p({"file-mediatype":"image",limit:1,"return-type":"array",modelValue:n.material.material_image}),c:e.p({name:"imgs",label:"(可选)"}),d:i._imports_0$1,e:n.material.material_name,f:e.o((e=>n.material.material_name=e.detail.value)),g:i._imports_1$3,h:e.t(n.material.category||"请选择资料类别"),i:["其他","各类表单","实验报告","往年试卷","竞赛","考研","课件","课后答案","软件","重点总结"],j:e.o((e=>n.material.category=["其他","各类表单","实验报告","往年试卷","竞赛","考研","课件","课后答案","软件","重点总结"][e.detail.value])),k:i._imports_2$1,l:n.material.course_name,m:e.o((e=>n.material.course_name=e.detail.value)),n:i._imports_3,o:n.material.download_link,p:e.o((e=>n.material.download_link=e.detail.value)),q:e.o((e=>m.navBack())),r:e.o(((...e)=>m.submitMaterialInfo&&m.submitMaterialInfo(...e)))}}],["__scopeId","data-v-4d71b69d"]]);wx.createPage(o);
